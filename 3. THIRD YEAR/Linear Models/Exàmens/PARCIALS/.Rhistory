install.packages("HistData")
###############PARCIAL MODELOS LINEALES###############
###############EJERCICIO 1###############
y<-c(2.1,1.9,2.0,2.2,1.2,0.8,1.1,0.9,5.1,5.2,4.9,4.9,7.9,8.0,8.2,7.9)
x<-c(rep(c(1,0,-1,0),4), rep(c(0,1,0,-1),4),rep(c(1,1,0,0),4),rep(c(2,2,-1,-1),4))
x<-matrix(x,ncol=4,byrow=T)
det(t(x)%*%x)
x
#a)
library(Matrix)
rankMatrix(x)
#[1] 3
#b)
library(MASS)
betas <-ginv(t(x)%*%x) %*% t(x) %*% y
betas
#i)
#No es estimable
#ii)
betas[1]+betas[2]
#[1] 5.00625
#iii)
betas[1]+betas[2]+betas[3]+betas[4]
#[1] 7
#d)
alpha<-c(1,1,1,1,0,0,0,0,1,1,1,1,2,2,2,2)
length(alpha)
beta<-c(0,0,0,0,1,1,1,1,1,1,1,1,2,2,2,2)
length(beta)
gamma<-c(-1,-1,-1,-1,0,0,0,0,0,0,0,0,-1,-1,-1,-1)
length(gamma)
delta<-c(0,0,0,0,-1,-1,-1,-1,0,0,0,0,-1,-1,-1,-1)
length(delta)
x1<-data.frame(y,alpha, beta, gamma, delta)
x1
g<-lm(y~0+alpha+beta+gamma, data=x1)   #delta no har?a falta ya que es combinaci?n lineal de las otras tres filas.
g
#i)
library("car")
linearHypothesis(g, "alpha+beta=5")
#Pr(>F)=0.9236>0.05     ->    aceptamos h0
#ii)
linearHypothesis(g, c("alpha+beta=5", "2*alpha+beta-gamma=7"))
#Pr(>F)=0.8556>0.05     ->    aceptamos h0
###############EJERCICIO 2###############
library(HistData)
data(GaltonFamilies)
help(GaltonFamilies)
# escull el teu cas:
# sexe <- "male"
# sexe <- "female"
GaltonFills <- GaltonFamilies[GaltonFamilies$gender=="female", ]
# selecci? a l'atzar d'un ?nic fill o filla per familia
rownames(GaltonFills) <- 1:dim(GaltonFills)[1]
set.seed(123)
ff <- function(x) as.numeric(sample(as.character(which(GaltonFills$family==x)),1))
ind <- sapply(unique(GaltonFills$family),ff)
# data.frame per treballar
GaltonFills1 <- GaltonFills[ind, ]
#a)
attach(GaltonFills1)
names(GaltonFills1)
#a)
#Primera regresi?n lineal
g1<-lm(childHeight~mother)
summary(g1)
#gr?fico de dispersi?n
plot(mother,childHeight)
#analisis de los residuos
par(mfrow = c(2, 2))
plot(g1)
abline(g1)
#b)
g1<-lm(childHeight~mother,data=GaltonFills1) #ya hecho en el apartado a
summary(g1)
#c)
#comprobamos que los residuos sean normales
r<-resid(g1)
shapiro.test(r)
#d)
#IC beta0 y beta1
confint(g1, level=0.90)
SCR<-sum(residus^2)
SCR
r<-resid(g1)
r
La variància estimada de l'estimació de 2α+β−γ és
