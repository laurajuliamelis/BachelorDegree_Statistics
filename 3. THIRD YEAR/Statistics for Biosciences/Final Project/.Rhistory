fit.contrast(modelo, "tract", coeff=c(1,-1,1,-1))
tract
levels(tract)
levels(tract) <- 1:4
library(gmodels)
fit.contrast(modelo, "tract", coeff=c(1,-1,1,-1))
tract
library(gmodels)
fit.contrast(model, "tract", coeff=c(1,-1,1,-1))
y <- c(255, 263,
256,	250,
243,	253,
251,	252,
285,	280,
268,	272,
278,	270,
281,	285,
226,	218,
210,	211,
218,	215,
214,	203,
214,	224,
233,	227,
231,	228,
216,	220)
calcat <- factor(rep(1:2, each = 8))
sexe <- factor(rep(1:2, each = 16))
atleta <- factor(rep(rep(1:4, each = 2), 4)
library(mixlm)
model <- lm(y ~ calcat + sexe + r(atleta)%in%(calcat:sexe) + calcat:sexe)
y <- c(255, 263,
256,	250,
243,	253,
251,	252,
285,	280,
268,	272,
278,	270,
281,	285,
226,	218,
210,	211,
218,	215,
214,	203,
214,	224,
233,	227,
231,	228,
216,	220)
calcat <- factor(rep(1:2, each = 8))
sexe <- factor(rep(1:2, each = 16))
atleta <- factor(rep(rep(1:4, each = 2), 4)
library(mixlm)
model <- lm(y ~ calcat + sexe + r(atleta)%in%(calcat:sexe) + calcat:sexe)
library(mixlm)
model <- lm(y ~ calcat + sexe + r(atleta)%in%(calcat:sexe) + calcat:sexe)
atleta <- factor(rep(rep(1:4, each = 2), 4)
library(mixlm)
model <- lm(y ~ calcat + sexe + r(atleta)%in%(calcat:sexe) + calcat:sexe)
atleta <- factor(rep(rep(1:4, each = 2), 4)
library(mixlm)
model <- lm(y ~ calcat + sexe + r(atleta)%in%(calcat:sexe) + calcat:sexe)
calcat <- factor(rep(1:2, each = 8))
sexe <- factor(rep(1:2, each = 16))
atleta <- factor(rep(rep(1:4, each = 2), 4)
)
y <- c(255, 263,
256,	250,
243,	253,
251,	252,
285,	280,
268,	272,
278,	270,
281,	285,
226,	218,
210,	211,
218,	215,
214,	203,
214,	224,
233,	227,
231,	228,
216,	220)
calcat <- factor(rep(1:2, each = 8))
sexe <- factor(rep(1:2, each = 16))
atleta <- factor(rep(rep(1:4, each = 2), 4))
library(mixlm)
model <- lm(y ~ calcat + sexe + r(atleta)%in%(calcat:sexe) + calcat:sexe)
calcat <- factor(rep(rep(1:2, each = 8),2))
model <- lm(y ~ calcat + sexe + r(atleta)%in%(calcat:sexe) + calcat:sexe)
summary(model)
Anova(model, type="III")
knitr::opts_chunk$set(echo = TRUE)
y <- c(255, 263,
256,	250,
243,	253,
251,	252,
285,	280,
268,	272,
278,	270,
281,	285,
226,	218,
210,	211,
218,	215,
214,	203,
214,	224,
233,	227,
231,	228,
216,	220)
calcat <- factor(rep(rep(1:2, each = 8),2))
sexe <- factor(rep(1:2, each = 16))
atleta <- factor(rep(rep(1:4, each = 2), 4))
library(mixlm)
model <- lm(y ~ calcat + sexe + r(atleta)%in%(calcat:sexe) + calcat:sexe)
Anova(model, type="III")
?IAPlot
interaction.plot(sexe, calcat, y)
library(mixlm)
model <- lm(y ~ calcat + sexe + r(atleta)%in%(calcat:sexe) + calcat:sexe)
Anova(model, type="III")
taula <- Anova(model, type="III")
MS <- taula['calcat:sexe:atleta', 'Mean Sq']
taula <- Anova(model, type="III")
MS <- taula["calcat:sexe:atleta", "Mean Sq"]
taula <- Anova(model, type="III")$Anova
MS <- taula["calcat:sexe:atleta", "Mean Sq"]
df <- taula['calcat:sexe:atleta', 'Df']
library(agricolae)
LSD.test(y, tipus:sexe, DFerror=df, MSerror=MS, group=FALSE)$comparison
taula <- Anova(model, type="III")$Anova
MS <- taula["calcat:sexe:atleta", "Mean Sq"]
df <- taula['calcat:sexe:atleta', 'Df']
library(agricolae)
LSD.test(y, calcat:sexe, DFerror=df, MSerror=MS, group=FALSE)$comparison
taula <- Anova(model, type="III")$Anova
MS <- taula['calcat:sexe:atleta', 'Mean Sq']
df <- taula['calcat:sexe:atleta', 'Df']
library(agricolae)
LSD.test(y, calcat:sexe, DFerror=df, MSerror=MS, group=FALSE)$comparison
taula <- Anova(model, type="III")$anova
MS <- taula['calcat:sexe:atleta', 'Mean Sq']
df <- taula['calcat:sexe:atleta', 'Df']
library(agricolae)
LSD.test(y, calcat:sexe, DFerror=df, MSerror=MS, group=FALSE)$comparison
?factor
y <- c(255, 263,
256,	250,
243,	253,
251,	252,
285,	280,
268,	272,
278,	270,
281,	285,
226,	218,
210,	211,
218,	215,
214,	203,
214,	224,
233,	227,
231,	228,
216,	220)
calcat <- factor(rep(rep(1:2, each = 8),2), labels = c("A", "B"))
sexe <- factor(rep(1:2, each = 16))
atleta <- factor(rep(rep(1:4, each = 2), 4))
library(mixlm)
model <- lm(y ~ calcat + sexe + r(atleta)%in%(calcat:sexe) + calcat:sexe)
Anova(model, type="III")
interaction.plot(sexe, calcat, y)
taula <- Anova(model, type="III")$anova
MS <- taula['calcat:sexe:atleta', 'Mean Sq']
df <- taula['calcat:sexe:atleta', 'Df']
library(agricolae)
LSD.test(y, calcat:sexe, DFerror=df, MSerror=MS, group=FALSE)$comparison
(mitjana <- mean(255, 263, 256,	250, 243,	253, 251,	252))
taula
(mitjana <- mean(255, 263, 256,	250, 243,	253, 251,	252))
Anova(model, type="III"
(mitjana <- mean(255, 263, 256,	250, 243,	253, 251,	252))
Anova(model, type="III")
(mitjana <- mean(255, 263, 256,	250, 243,	253, 251,	252))
TA <- Anova(model, type="III")
(mitjana <- mean(255, 263, 256,	250, 243,	253, 251,	252))
TA <- Anova(model, type="III")
TA$var.comps
(mitjana <- mean(255, 263, 256,	250, 243,	253, 251,	252))
TA <- Anova(model, type="III")
var <- sum(TA$var.comps)
(mitjana <- mean(255, 263, 256,	250, 243,	253, 251,	252))
TA <- Anova(model, type="III")
(var <- sum(TA$var.comps))
(mitjana <- mean(255, 263, 256,	250, 243,	253, 251,	252))
TA <- Anova(model, type="III")
(var <- sum(TA$var.comps, is.na=T))
(mitjana <- mean(255, 263, 256,	250, 243,	253, 251,	252))
TA <- Anova(model, type="III")
(var <- sum(TA$var.comps, is.na=F))
(mitjana <- mean(255, 263, 256,	250, 243,	253, 251,	252))
TA <- Anova(model, type="III")
(var <- sum(TA$var.comps, is.null=F))
(mitjana <- mean(255, 263, 256,	250, 243,	253, 251,	252))
TA <- Anova(model, type="III")
(var <- sum(TA$var.comps, is.null=T))
(mitjana <- mean(255, 263, 256,	250, 243,	253, 251,	252))
TA <- Anova(model, type="III")
(var <- sum(TA$var.comps[3:4]))
TA$var.comps
(mitjana <- mean(255, 263, 256,	250, 243,	253, 251,	252))
TA <- Anova(model, type="III")
(var <- sum(TA$var.comps[4:5]))
(mitjana <- mean(255, 263, 256,	250, 243,	253, 251,	252))
TA <- Anova(model, type="III")
(var <- sum(TA$var.comps[4:5]))
1-pnorm(4*60+15, mean= 255, sigma=sqrt(46.11458))
(mitjana <- mean(255, 263, 256,	250, 243,	253, 251,	252))
TA <- Anova(model, type="III")
(var <- sum(TA$var.comps[4:5]))
1-pnorm(4*60+15, 255, sqrt(46.11458))
(mitjana <- mean(255, 263, 256,	250, 243,	253, 251,	252))
TA <- Anova(model, type="III")
(var <- sum(TA$var.comps[4:5]))
pnorm(4*60+15, 255, sqrt(46.11458))
(mitjana <- mean(255, 263, 256,	250, 243,	253, 251,	252))
TA <- Anova(model, type="III")
(var <- sum(TA$var.comps[4:5]))
pnorm(4*60+15, 255, sqrt(46.11458))
pnorm(4*60+15, 252.875, sqrt(46.11458))
(mitjana <- mean(255, 263, 256,	250))
TA <- Anova(model, type="III")
(var <- sum(TA$var.comps[4:5]))
pnorm(4*60+15, 255, sqrt(46.11458))
pnorm(4*60+15, 252.875, sqrt(46.11458))
(mitjana <- mean(c(255, 263, 256,	250, 243,	253, 251,	252))
TA <- Anova(model, type="III")
(mitjana <- mean(c(255, 263, 256,	250, 243,	253, 251,	252)))
TA <- Anova(model, type="III")
(var <- sum(TA$var.comps[4:5]))
pnorm(4*60+15, 255, sqrt(46.11458))
pnorm(4*60+15, 252.875, sqrt(46.11458))
library(FrF2)
disseny <- FrF2(nruns = 8, nfactors = 5, randomize = F)
usabilitat <- c(81.9, 86.6, 26.4, 85.8, 141.9, 145.8, 85.6, 144.8)
disseny <- add.response(design = disseny, response = usabilitat)
library(FrF2)
disseny <- FrF2(nruns = 8, nfactors = 5, randomize = F)
usabilitat <- c(81.9, 86.6, 26.4, 85.8, 141.9, 145.8, 85.6, 144.8)
disseny <- add.response(design = disseny, response = usabilitat)
summary(disseny)
library(FrF2)
disseny <- FrF2(nruns = 8, nfactors = 5, randomize = F)
usabilitat <- c(81.9, 86.6, 26.4, 85.8, 141.9, 145.8, 85.6, 144.8)
disseny <- add.response(design = disseny, response = usabilitat)
summary(lm(disseny))
?DanielPlot()
DanielPlot(fit = disseny, autolab = F)
?MEPlot()
MEPlot(obj = disseny, select=c("B", "C", "D"))
MEPlot(obj = disseny, select=c(2,3,4))
IAPlot(obj = disseny, select=c(2,4))
MEPlot(obj = disseny, select=2)
MEPlot(obj = disseny, select=c(2))
MEPlot(obj = disseny, select=c(2,3,4))
MEPlot(obj = disseny, select=c(2))
MEPlot(obj = disseny, select= 2)
MEPlot(obj = disseny, select=c(2,3,4))
knitr::opts_chunk$set(echo = TRUE)
y <- c(0.22, 0.56, 0.66, 0.89,
0.68, 0.91, 1.06, 0.80,
0.68, 0.45, 0.72, 0.89,
2.53, 2.70, 2.1, 1.50,
2.59 ,1.43, 1.35 ,0.74,
0.56, 1.37, 1.87, 1.21,
0.22, 0.22, 0.20, 0.11,
0.45, 0.28, 1.24, 0.86,
0.22, 0.33, 0.34, 0.20,
0.22, 0.80, 0.80, 0.37,
0.22, 0.62, 0.89, 0.95,
0.22, 0.56, 0.89, 0.63)
y <- c(0.22, 0.56, 0.66, 0.89,
0.68, 0.91, 1.06, 0.80,
0.68, 0.45, 0.72, 0.89,
2.53, 2.70, 2.1, 1.50,
2.59 ,1.43, 1.35 ,0.74,
0.56, 1.37, 1.87, 1.21,
0.22, 0.22, 0.20, 0.11,
0.45, 0.28, 1.24, 0.86,
0.22, 0.33, 0.34, 0.20,
0.22, 0.80, 0.80, 0.37,
0.22, 0.62, 0.89, 0.95,
0.22, 0.56, 0.89, 0.63)
zona <- factor(rep(1:4, each=12))
punt <- factor(rep(rep(1:3, each=4), 4))
periode <- factor(rep(1:4, 12))
y <- c(0.22, 0.56, 0.66, 0.89,
0.68, 0.91, 1.06, 0.80,
0.68, 0.45, 0.72, 0.89,
2.53, 2.70, 2.1, 1.50,
2.59 ,1.43, 1.35 ,0.74,
0.56, 1.37, 1.87, 1.21,
0.22, 0.22, 0.20, 0.11,
0.45, 0.28, 1.24, 0.86,
0.22, 0.33, 0.34, 0.20,
0.22, 0.80, 0.80, 0.37,
0.22, 0.62, 0.89, 0.95,
0.22, 0.56, 0.89, 0.63)
zona <- factor(rep(1:4, each=12))
punt <- factor(rep(rep(1:3, each=4), 4))
periode <- factor(rep(1:4, 12))
library(mixlm)
model <- lm(y ~ zona + r(punt)%in%zona + periode + zona:periode)
y <- c(0.22, 0.56, 0.66, 0.89,
0.68, 0.91, 1.06, 0.80,
0.68, 0.45, 0.72, 0.89,
2.53, 2.70, 2.1, 1.50,
2.59 ,1.43, 1.35 ,0.74,
0.56, 1.37, 1.87, 1.21,
0.22, 0.22, 0.20, 0.11,
0.45, 0.28, 1.24, 0.86,
0.22, 0.33, 0.34, 0.20,
0.22, 0.80, 0.80, 0.37,
0.22, 0.62, 0.89, 0.95,
0.22, 0.56, 0.89, 0.63)
zona <- factor(rep(1:4, each=12))
punt <- factor(rep(rep(1:3, each=4), 4))
periode <- factor(rep(1:4, 12))
library(mixlm)
model <- lm(y ~ zona + r(punt)%in%zona + periode + zona:periode)
y <- c(0.22, 0.56, 0.66, 0.89,
0.68, 0.91, 1.06, 0.80,
0.68, 0.45, 0.72, 0.89,
2.53, 2.70, 2.1, 1.50,
2.59 ,1.43, 1.35 ,0.74,
0.56, 1.37, 1.87, 1.21,
0.22, 0.22, 0.20, 0.11,
0.45, 0.28, 1.24, 0.86,
0.22, 0.33, 0.34, 0.20,
0.22, 0.80, 0.80, 0.37,
0.22, 0.62, 0.89, 0.95,
0.22, 0.56, 0.89, 0.63)
zona <- factor(rep(1:4, each=12))
punt <- factor(rep(rep(1:3, each=4), 4))
periode <- factor(rep(1:4, 12))
library(mixlm)
model <- lm(y ~ zona + r(punt)%in%zona + periode + zona:periode)
library(mixlm)
y <- c(0.22, 0.56, 0.66, 0.89,
0.68, 0.91, 1.06, 0.80,
0.68, 0.45, 0.72, 0.89,
2.53, 2.70, 2.1, 1.50,
2.59 ,1.43, 1.35 ,0.74,
0.56, 1.37, 1.87, 1.21,
0.22, 0.22, 0.20, 0.11,
0.45, 0.28, 1.24, 0.86,
0.22, 0.33, 0.34, 0.20,
0.22, 0.80, 0.80, 0.37,
0.22, 0.62, 0.89, 0.95,
0.22, 0.56, 0.89, 0.63)
zona <- factor(rep(1:4, each=12))
punt <- factor(rep(rep(1:3, each=4), 4))
periode <- factor(rep(1:4, 12))
library(mixlm)
model <- lm(y ~ zona + r(punt)%in%zona + periode + zona:periode)
y <- c(0.22, 0.56, 0.66, 0.89,
0.68, 0.91, 1.06, 0.80,
0.68, 0.45, 0.72, 0.89,
2.53, 2.70, 2.1, 1.50,
2.59 ,1.43, 1.35 ,0.74,
0.56, 1.37, 1.87, 1.21,
0.22, 0.22, 0.20, 0.11,
0.45, 0.28, 1.24, 0.86,
0.22, 0.33, 0.34, 0.20,
0.22, 0.80, 0.80, 0.37,
0.22, 0.62, 0.89, 0.95,
0.22, 0.56, 0.89, 0.63)
zona <- factor(rep(1:4, each=12))
punt <- factor(rep(rep(1:3, each=4), 4))
periode <- factor(rep(1:4, 12))
library(mixlm)
model <- lm(y ~ zona + r(punt)%in%zona + periode + zona:periode)
punt
r(punt)
Anova(model, type="III")
y <- c(0.22, 0.56, 0.66, 0.89,
0.68, 0.91, 1.06, 0.80,
0.68, 0.45, 0.72, 0.89,
2.53, 2.70, 2.1, 1.50,
2.59 ,1.43, 1.35 ,0.74,
0.56, 1.37, 1.87, 1.21,
0.22, 0.22, 0.20, 0.11,
0.45, 0.28, 1.24, 0.86,
0.22, 0.33, 0.34, 0.20,
0.22, 0.80, 0.80, 0.37,
0.22, 0.62, 0.89, 0.95,
0.22, 0.56, 0.89, 0.63)
zona <- factor(rep(1:4, each=12))
punt <- factor(rep(rep(1:3, each=4), 4))
periode <- factor(rep(1:4, 12))
library(mixlm)
model <- lm(y ~ zona + r(punt)
%in%zona + periode + zona:periode)
y <- c(0.22, 0.56, 0.66, 0.89,
0.68, 0.91, 1.06, 0.80,
0.68, 0.45, 0.72, 0.89,
2.53, 2.70, 2.1, 1.50,
2.59 ,1.43, 1.35 ,0.74,
0.56, 1.37, 1.87, 1.21,
0.22, 0.22, 0.20, 0.11,
0.45, 0.28, 1.24, 0.86,
0.22, 0.33, 0.34, 0.20,
0.22, 0.80, 0.80, 0.37,
0.22, 0.62, 0.89, 0.95,
0.22, 0.56, 0.89, 0.63)
zona <- factor(rep(1:4, each=12))
punt <- factor(rep(rep(1:3, each=4), 4))
periode <- factor(rep(1:4, 12))
library(mixlm)
model <- lm(y ~ zona + r(periode)%in%zona + periode + zona:periode)
y <- c(0.22, 0.56, 0.66, 0.89,
0.68, 0.91, 1.06, 0.80,
0.68, 0.45, 0.72, 0.89,
2.53, 2.70, 2.1, 1.50,
2.59 ,1.43, 1.35 ,0.74,
0.56, 1.37, 1.87, 1.21,
0.22, 0.22, 0.20, 0.11,
0.45, 0.28, 1.24, 0.86,
0.22, 0.33, 0.34, 0.20,
0.22, 0.80, 0.80, 0.37,
0.22, 0.62, 0.89, 0.95,
0.22, 0.56, 0.89, 0.63)
zona <- factor(rep(1:4, each=12))
punt <- factor(rep(rep(1:3, each=4), 4))
periode <- factor(rep(1:4, 12))
library(mixlm)
model <- lm(y ~ zona + r(periode) + zona:periode)
y <- c(0.22, 0.56, 0.66, 0.89,
0.68, 0.91, 1.06, 0.80,
0.68, 0.45, 0.72, 0.89,
2.53, 2.70, 2.1, 1.50,
2.59 ,1.43, 1.35 ,0.74,
0.56, 1.37, 1.87, 1.21,
0.22, 0.22, 0.20, 0.11,
0.45, 0.28, 1.24, 0.86,
0.22, 0.33, 0.34, 0.20,
0.22, 0.80, 0.80, 0.37,
0.22, 0.62, 0.89, 0.95,
0.22, 0.56, 0.89, 0.63)
zona <- factor(rep(1:4, each=12))
punt <- factor(rep(rep(1:3, each=4), 4))
periode <- factor(rep(1:4, 12))
library(mixlm)
model <- lm(y ~ zona + r(punt)%in%zona + periode + zona:periode)
Anova(model, type="III")
y <- c(0.22, 0.56, 0.66, 0.89,
0.68, 0.91, 1.06, 0.80,
0.68, 0.45, 0.72, 0.89,
2.53, 2.70, 2.1, 1.50,
2.59 ,1.43, 1.35 ,0.74,
0.56, 1.37, 1.87, 1.21,
0.22, 0.22, 0.20, 0.11,
0.45, 0.28, 1.24, 0.86,
0.22, 0.33, 0.34, 0.20,
0.22, 0.80, 0.80, 0.37,
0.22, 0.62, 0.89, 0.95,
0.22, 0.56, 0.89, 0.63)
zona <- factor(rep(1:4, each=12))
punt <- factor(rep(rep(1:3, each=4), 4))
periode <- factor(rep(1:4, 12))
library(mixlm)
model <- lm(y ~ zona + r(punt)%in%zona + periode + zona:periode)
Anova(model, type="III")
install.packages("mixlm")
install.packages("mixlm")
source("https://bioconductor.org/biocLite.R")
source("https://bioconductor.org/biocLite.R")
knitr::opts_chunk$set(echo = TRUE) # si echo=F al fer Knit tots els chunks desapareixen, nomes surten els resultats
require(Biobase)
require(affy)
sampleInfo <- read.AnnotatedDataFrame(file.path(dataDir,"targets.txt"),
header = TRUE, row.names = 1, sep="\t") #my targets
workingDir <- setwd("E:/Estad?stica Bioci?ncies/Microarray Analisis")
workingDir <- setwd("E:/Estadística Biociències/Microarray Analisis")
dataDir <-file.path(workingDir, "data")
resultsDir <- file.path(workingDir,"results")
setwd(workingDir)
sampleInfo <- read.AnnotatedDataFrame(file.path(dataDir,"targets.txt"),
header = TRUE, row.names = 1, sep="\t") #my targets
fileNames <- rownames(pData(sampleInfo))
rawData <- read.affybatch(filenames=file.path(dataDir,fileNames),
phenoData=sampleInfo)
################### Plot Histograma
info <- data.frame(grupo=pData(rawData)$grupo)
################### Gr?fico degradaci?n
deg<-AffyRNAdeg(rawData, log.it=T)
################### Plot gráfico degradación
###################Plot Dendrograma
### La muestras del mismo grupo deber?an agruparse juntas
clust.euclid.average <- hclust(dist(t(exprs(rawData))),method="average")
setwd("C:/Users/Ricard/Desktop/Análisis/Análisis")
setwd("C:/Users/Ricard/Documents/Análisis")
setwd("~/Análisis")
setwd("C:/Users/Ricard/Documents/Análisis")
setwd("~/Análisis")
setwd("~/Análisis")
setwd("~/Analisis")
workingDir <-"~/Analisis"
dataDir <-file.path(workingDir, "DADES2")
resultsDir <- file.path(workingDir,"resultados")
setwd(workingDir)
options(width=80)
options(digits=5)
source("http://bioconductor.org/biocLite.R")
if (!(require(mouse4302.db))){
biocLite("mouse4302.db")
}
if (!(require(annaffy))){
biocLite("annaffy")
}
