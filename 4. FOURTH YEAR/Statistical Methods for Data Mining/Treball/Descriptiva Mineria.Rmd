
```{r}
dd <- read.csv('Booking_data.csv', sep = ",")
dd <- dd[, -1]
na_count <-sapply(dd, function(y) sum(length(which(is.na(y)))))
na_count <- data.frame(na_count)
```

```{r}
require(knitr)
require(rmarkdown)
na <- c(23, 23, 23, 23, 23, 3209, 14, 10, 2)
df <- data.frame(
        variable = c("Hotel_lat", "Hotel_lng", "Businesses_100m", "Businesses_1km", "Businesses_5km",
                     "Room_Type_Level", "Trip_Type","Reviewer_Nationality", "Negative_Review"),
        nre.Missings = na, sep = " ")
kable(df, caption = "Taula de valors missing")
```

```{r}
require(ggplot2)
df <- data.frame(variable = names(dd),
                 missings = c(0, 0, 0, 0, 23, 23, 23, 23, 23, 3209, 0, 14, 0, 0, 
        0, 0, 0, 0, 0, 0, 10, 2, 0, 0, 0, 0, 0, 0, 0, 0))
labels <- "missings"
ggplot(data=df, aes(x=variable, y= missings)) + theme(axis.title = element_text(size=10)) + geom_bar(stat="identity") + labs(x = "missings", y = "variable", size = 0.6)  + coord_flip() 
```

################################  DESCRIPTIVA UNIVARIANTE ###################################
# HOTEL COUNTRY
```{r, warning=F, comment = "", message=FALSE}
t1<-summary(dd$Hotel_Country)
```

```{r, fig.cap="Pie Chart Hotel_Country (Raw)", warning=F, comment = "", message=FALSE, fig.height = 3.8, fig.width=4.4}
library(colorspace)
paleta<-sequential_hcl(length(levels(dd[,3])))
par(cex.main = 0.7, cex.axis = 0.6, cex.lab = 0.6)	
pie(t1,labels = paste(c("AT","ES","FR","GB","IT","NL"), round(table(dd$Hotel_Country)/5000,2)*100,'%'), col =paleta,  main = "Hotel_Country (Raw)")
legend("topleft", c("AT","ES","FR","GB","IT","NL"), cex=0.5, fill=paleta)
```
 
# HOTEL CITY
```{r}
t2<- summary(dd$Hotel_City)
```

```{r}
paleta<-sequential_hcl(length(levels(dd[,2])))
  par(las = 3, oma = c(2, 1, 0, 0), cex.main = 0.7, cex.axis = 0.6, cex.lab = 0.7)  
  barplot(t2, ylim = c(0, 3500),col = paleta ,main = "Hotel_City (Raw)", ylab = "Frequency")
 
  # legend("topright",  levels(dd[,4]), cex=0.45, fill=paleta)
```

# HOTEL_LAT Y HOTEL_LONG
```{r}
summary(dd$Hotel_lat)
summary(dd$Hotel_lng)
```

```{r}
paleta<-sequential_hcl(length(levels(dd[,1])))
  par(oma = c(2, 1, 0, 0), cex.main = 0.7, cex.axis = 0.6, cex.lab = 0.6, mfrow = c(1, 2)) 
  boxplot(dd$Hotel_lat, data = dd, col = 'lightsteelblue3', pch = 16,
          main = "Hotel_lat (Raw)")
  boxplot(dd$Hotel_lng, data = dd, col = "lightsteelblue3", pch = 16, 
          main = "Hotel_lng (Raw)")
```

# ROOM TYPE LEVEL 
```{r}
summary(dd$Room_Type_Level)
```

```{r}
paleta<-sequential_hcl(length(levels(dd[,2])))
par(las = 2, oma = c(2, 1, 0, 0), cex.main = 0.7, cex.axis = 0.6, cex.lab = 0.6)  
barplot(table(dd$Room_Type_Level), ylim = c(0, 3500), col = paleta ,main = "Room_Type_Level (Raw)", ylab = "Frequency")
##legend("topleft",  levels(dd[,10]), cex=0.45, fill=paleta)
```

# GUEST_TYPE, TRIP_TYPE
```{r}
summary(dd$Guest_Type)
summary(dd$Trip_Type)
```

```{r}
par(las=3, oma = c(2, 1, 0, 0), cex.main = 0.7, cex.axis = 0.6, cex.lab = 0.6,mfrow=c(1,2)) 
paleta<-sequential_hcl(length(levels(dd[,2])))
barplot(table(dd$Guest_Type), col = paleta ,main = "Guest_Type (Raw)", ylab = "Frequency")
#legend("topright",  levels(dd[,11]), cex=0.55, fill=paleta)
barplot(table(dd$Trip_Type), col = paleta ,main = "Trip_Type (Raw)", ylab = "Frequency")
#legend("topleft",  levels(dd[,12]), cex=0.5, fill=paleta)
```

# STAY DURATION
```{r}
summary(dd$Stay_Duration)
```

```{r}
paleta<-sequential_hcl(length(levels(dd[,2])))
par(oma = c(2, 1, 0, 0), cex.main = 0.7, cex.axis = 0.6, cex.lab = 0.6) 
hist(dd$Stay_Duration, xlab = "# Dies", breaks = 20, col = paleta,
     main = "Stay_Duration (Raw)", ylim = c(0, 3500))
```

# Is_Hotel_Holiday Y Is_Reviewer_Holiday
```{r}
#paleta<-sequential_hcl(length(levels(dd[,6])))
par(oma = c(2, 1, 0, 0), cex.main = 0.7, cex.axis = 0.6, cex.lab = 0.6, mfrow = c(1, 2)) 
paleta<-sequential_hcl(3)
pie(table(dd$Is_Hotel_Holiday), col = paleta, main = "Is_Hotel_Holiday (Raw)")
legend("topright", c("No","Yes"), cex=0.75, fill=paleta)
pie(table(dd$Is_Reviewer_Holiday), col = paleta, main = "Is_Reviewer_Holiday (Raw)")
legend("topright", c("No","Yes"), cex=0.75, fill=paleta)
```

```{r}
sum(dd$Is_Hotel_Holiday*dd$Is_Reviewer_Holiday)
```

# Total_Number_of_Reviews
```{r}
summary(dd$Total_Number_of_Reviews)
```

```{r}
par(oma = c(2, 1, 0, 0), cex.main = 0.7, cex.axis = 0.6, cex.lab = 0.6)
paleta<-sequential_hcl(length(levels(dd[,2])))
hist(dd$Total_Number_of_Reviews, xlab = "# Dies", breaks = 20, col = paleta,
     main = "Total_Number_of_Reviews (Raw)")
```

# Review_Positivity_Rate
```{r, warning=F, comment = "", message = FALSE}
summary(dd$Review_Positivity_Rate)
```

```{r}
par(oma = c(2, 1, 0, 0), cex.main = 0.7, cex.axis = 0.6, cex.lab = 0.6, mfrow = c(1, 2)) 
paleta<-sequential_hcl(2)
pie(table(dd$Review_Is_Positive), col = paleta, main = "Review_Is_Positive (Raw)")
legend("topright", c("No","Yes"), cex=0.75, fill=paleta)
paleta<-sequential_hcl(length(levels(dd[,2])))
hist(dd$Review_Positivity_Rate, xlab = "Score", breaks = 100, col =paleta,
     main = "Review_Positivity_Rate (Raw)")
```

# Reviewer_Nationality
```{r, warning=F, comment = "", message = FALSE}
summary(dd$Reviewer_Nationality)
```

# Review_Total_Negative_Word_Counts / Review_Total_Positive_Word_Counts
```{r, warning=F, comment = "", message = FALSE}
summary(dd$Review_Total_Negative_Word_Counts)
summary(dd$Review_Total_Positive_Word_Counts)
```

```{r, fig.cap="Boxplot Paraules als comentaris negatius/positius (Raw)", warning=F, comment = "", message=FALSE, fig.height = 4.2, fig.width=6}
paleta<-sequential_hcl(length(levels(dd[,2])))
par(oma = c(2, 1, 0, 0), cex.main = 0.7, cex.axis = 0.6, cex.lab = 0.6, mfrow = c(1, 2)) 
boxplot(dd$Review_Total_Negative_Word_Counts, data = dd, col = 'lightsteelblue3', pch = 16, 
        main = "Review_Total_Negative_Word_Counts (Raw)")
boxplot(dd$Review_Total_Positive_Word_Counts, data = dd, col ='lightsteelblue3', pch = 16, 
        main = "Review_Total_Positive_Word_Counts (Raw)")
```

# Average score / Reviewer score
```{r, warning=F, comment = "", message = FALSE}
summary(dd$Average_Score)
summary(dd$Reviewer_Score)
```

```{r}
par(oma = c(2, 1, 0, 0), cex.main = 0.7, cex.axis = 0.6, cex.lab = 0.6, mfrow = c(1, 2)) 
boxplot(dd$Average_Score, data = dd, col = "lightsteelblue3", pch = 16, 
        main = "Average_Score (Raw)")
boxplot(dd$Reviewer_Score, data = dd, col = "lightsteelblue3", pch = 16, 
        main = "Reviewer_Score (Raw)")
```

#Total_Number_of_Reviews_Reviewer_Has_Given
```{r, warning=F, comment = "", message = FALSE}
summary(dd$Total_Number_of_Reviews_Reviewer_Has_Given)
```

```{r}
par(oma = c(2, 1, 0, 0), cex.main = 0.7, cex.axis = 0.6, cex.lab = 0.6) 
paleta<-sequential_hcl(length(levels(dd[,2])))
hist(dd$Total_Number_of_Reviews_Reviewer_Has_Given, xlab = "# Ressenyes v??lides", breaks = 20, col = paleta,
     main = "Total_Number_of_Reviews_Reviewer_Has_Given (Raw)")
```

# Additional_Number_of_Scoring
```{r}
summary(dd$Additional_Number_of_Scoring)
```

```{r, fig.cap="Histograma Additional_Number_of_Scoring (Raw)", warning=F, comment = "", message=FALSE, fig.height = 4.8, fig.width=5.5}
par(oma = c(2, 1, 0, 0), cex.main = 0.7, cex.axis = 0.6, cex.lab = 0.6) 
hist(dd$Additional_Number_of_Scoring, xlab = "# Ressenyes v??lides", breaks = 20, col = paleta,
     main = "Additional_Number_of_Scoring (Raw)")
```

# Submitted_from_Mobile
```{r}
par(oma = c(2, 1, 0, 0), cex.main = 0.7, cex.axis = 0.6, cex.lab = 0.6, mfrow = c(1, 2)) 
paleta<-sequential_hcl(2)
pie(table(dd$Submitted_from_Mobile), col = paleta, main = "Submitted_from_Mobile (Raw)")
legend("topright", c("No","Yes"), cex=0.75, fill=paleta)
```


################################  PREPOCESSING  #############################################



