# Dades
bd <- read.csv("Crossover.csv", header=T, sep=";")
bd <- as.data.frame(bd)
# 1. ¿Cuál es el efecto estimado puntualmente de Sildenafil?
n1 <- 9  # CANVIAR-HO SEGONS LES DADES!!
n2 <- 12 # CANVIAR-HO SEGONS LES DADES!!
d_i1 <- bd[1:n1,4]- bd[(n1+1):(2*n1),4]
d_i2 <- bd[(2*n1+1):((2*n1)+n2),4]- bd[((2*n1)+n2+1):nrow(bd),4]
d1 <- mean(d_i1)
d2 <- mean(d_i2)
efecto <- (d1-d2)/2
efecto # RESULTAT 1
# 2. Indique el extremo inferior del IC (95%) para el efecto de los tratados con Sildenafil.
var1 <- var(d_i1)
var2 <- var(d_i2)
s2 <- (((n1-1)*var1)+((n2-1)*var2))/(n1+n2-2)
s <- sqrt(s2)
pvalor <-  qt(0.025, (n1+n2-2), lower.tail = F)
IC_L <- efecto - (0.5*pvalor*s*sqrt((1/n1) + (1/n2)))
IC_L # RESULTAT 2
# 3. Idem para el extremo superior.
IC_U <- efecto + (0.5*pvalor*s*sqrt((1/n1) + (1/n2)))
IC_U # RESULTAT 3
# 4. ¿Influye el hecho de haber realizado la prueba antes o después? Obtenga ahora la estimación
# por IC del efecto periodo; extremo inferior:
efecto_período <- (d1 + d2)/2
efecto_período
IC_L_período <- efecto_período - (0.5*pvalor*s*sqrt((1/n1) + (1/n2)))
IC_L_período # RESULTAT 4
# 5. Idem para el extremo superior.
IC_U_período <- efecto_período + (0.5*pvalor*s*sqrt((1/n1) + (1/n2)))
IC_U_período # RESULTAT 5
# 6. ¿Presenta efectos arrastrados el tratamiento, a pesar del periodo de lavado? Ya sabemos que
# esta es una prueba con escasa potencia, pero estime el posible efecto tardío del tratamiento;
# extremo inferior:
suma1 <- bd[1:n1,4]+bd[(n1+1):(2*n1),4]
suma2 <- bd[(2*n1+1):((2*n1)+n2),4]+ bd[((2*n1)+n2+1):nrow(bd),4]
efecto_tardío <- suma1-suma2
efecto_tardío <- sum(suma1)-sum(suma2)
efecto_tardío
suma1
t3<-t.test(suma1, suma2, var.equal=TRUE)
t3$conf.int[1]
t3$conf.int[2]
t3
efecto_tardío <- mean(suma1)-mean(suma2)
efecto_tardío
IC_L_tardío <- efecto_tardío - (0.5*pvalor*s*sqrt((1/n1) + (1/n2)))
IC_L_tardío # RESULTAT 6
# 7. Idem para el extremo superior.
IC_U_tardío <- efecto_tardío + (0.5*pvalor*s*sqrt((1/n1) + (1/n2)))
IC_U_tardío # RESULTAT 7
IC_L_tardío <- efecto_tardío - (pvalor*s*sqrt((1/n1) + (1/n2)))
IC_L_tardío # RESULTAT 6
# 7. Idem para el extremo superior.
IC_U_tardío <- efecto_tardío + (pvalor*s*sqrt((1/n1) + (1/n2)))
IC_U_tardío # RESULTAT 7
var1_tardío <- var(suma1)
var2_tardío <- var(suma2)
s2_tardío <- (((n1-1)*var1_tardío)+((n2-1)*var2_tardío))/(n1+n2-2)
s_tardío <- sqrt(s2_tardío)
pvalor <-  qt(0.025, (n1+n2-2), lower.tail = F)
IC_L_tardío <- efecto_tardío - (pvalor*s_tardío*sqrt((1/n1) + (1/n2)))
IC_L_tardío # RESULTAT 6
# 7. Idem para el extremo superior.
IC_U_tardío <- efecto_tardío + (pvalor*s_tardío*sqrt((1/n1) + (1/n2)))
IC_U_tardío # RESULTAT 7
#Preguntas 8 y 9
respuesta<-c(82,85.5,82,91,86,89.5,89.5,82,75,80,70.5,87,81,85,92.5,67.5,76,71,83.5,85.5,88,83.5,77,75.5,79.5,81.5,87,83,78.5,86.5,80.5,88,90,82,73,81)
tipo<-c(rep('A1',8),rep('B2',8),rep('B1',10),rep('A2',10))
datos<-data.frame(respuesta,tipo)
View(datos)
# 8. ¿En cuánto estima que vale la variancia intraindividuos?
tipo<-c(rep('A1',9),rep('B2',9),rep('B1',12),rep('A2',12))
m1<-lm(bd$Y~tipo)
summary(m1)
anova(m1)
v1<-var(0.5*d1)
v2<-var(0.5*d2)
vi<-v1+v2
v1
v1<-var(0.5*d_i1)
v2<-var(0.5*d_i2)
vi<-v1+v2
v1
v2
v1
#Preguntas 8 y 9
respuesta<-c(82,85.5,82,91,86,89.5,89.5,82,75,80,70.5,87,81,85,92.5,67.5,76,71,83.5,85.5,88,83.5,77,75.5,79.5,81.5,87,83,78.5,86.5,80.5,88,90,82,73,81)
tipo<-c(rep('A1',8),rep('B2',8),rep('B1',10),rep('A2',10))
datos<-data.frame(respuesta,tipo)
m1<-lm(respuesta~tipo)
summary(m1)
anova(m1)
v1<-var(0.5*d1)
v2<-var(0.5*d2)
vi<-v1+v2
d<- c(d_i1,d_i2)
d
var(d)
var(d)/2
var(mean(d))
# 8. ¿En cuánto estima que vale la variancia intraindividuos?
intra <- s2/2
intra
# 9. Halle un valor estimado de la variancia entreindividuos.
inter <- (s2_tardío-(2*intra))/4
inter
setwd("~/Desktop/Estadística/4. Quart/Primer quatri/ESTADÍSTICA MÈDICA/BLOC 2. Dissenys especials de prova/24.10.2018")
bd <- read.csv("Crossover.csv", header=T, sep=";")
bd <- as.data.frame(bd)
View(bd)
bd <- read.csv("Crossover.csv", header=T, sep=";")
bd <- as.data.frame(bd)
n1 <- 8  # CANVIAR-HO SEGONS LES DADES!!
n2 <- 12 # CANVIAR-HO SEGONS LES DADES!!
d_i1 <- bd[1:n1,4]- bd[(n1+1):(2*n1),4]
d_i2 <- bd[(2*n1+1):((2*n1)+n2),4]- bd[((2*n1)+n2+1):nrow(bd),4]
d1 <- mean(d_i1)
d2 <- mean(d_i2)
efecto <- (d1-d2)/2
efecto # RESULTAT 1
var1 <- var(d_i1)
var2 <- var(d_i2)
s2 <- (((n1-1)*var1)+((n2-1)*var2))/(n1+n2-2)
s <- sqrt(s2)
pvalor <-  qt(0.025, (n1+n2-2), lower.tail = F)
IC_L <- efecto - (0.5*pvalor*s*sqrt((1/n1) + (1/n2)))
IC_L # RESULTAT 2
# 3. Idem para el extremo superior.
IC_U <- efecto + (0.5*pvalor*s*sqrt((1/n1) + (1/n2)))
IC_U # RESULTAT 3
efecto_per?odo <- (d1 + d2)/2
efecto_per?odo
efecto_período <- (d1 + d2)/2
efecto_período
IC_L_período <- efecto_período - (0.5*pvalor*s*sqrt((1/n1) + (1/n2)))
IC_L_período # RESULTAT 4
# 5. Idem para el extremo superior.
IC_U_período <- efecto_período + (0.5*pvalor*s*sqrt((1/n1) + (1/n2)))
IC_U_período # RESULTAT 5
suma1 <- bd[1:n1,4]+bd[(n1+1):(2*n1),4]
suma2 <- bd[(2*n1+1):((2*n1)+n2),4]+ bd[((2*n1)+n2+1):nrow(bd),4]
efecto_tardío <- mean(suma1)-mean(suma2)
efecto_tardío
var1_tardío <- var(suma1)
var2_tardío <- var(suma2)
s2_tardío <- (((n1-1)*var1_tardío)+((n2-1)*var2_tardío))/(n1+n2-2)
s_tardío <- sqrt(s2_tardío)
pvalor <-  qt(0.025, (n1+n2-2), lower.tail = F)
IC_L_tardío <- efecto_tardío - (pvalor*s_tardío*sqrt((1/n1) + (1/n2)))
IC_L_tardío # RESULTAT 6
IC_U_tardío <- efecto_tardío + (pvalor*s_tardío*sqrt((1/n1) + (1/n2)))
IC_U_tardío # RESULTAT 7
# 8. ?En cu?nto estima que vale la variancia intraindividuos?
intra <- s2/2
intra # RESULTAT 8
entre <- (s2_tardío-(2*intra))/4
entre # RESULTAT 9
720/7
720/7-(1.96)^2
2*1.96
8.1819/2
2,2E-05
2.2E-05
sqrt(3.5)
sqrt(2/20)
intra <- sqrt(3.5)
efect <- 6
N <- n1 + n2
intra <- sqrt(3.5)
sq <- sqrt(2/N)
zeta_beta <- (efect - (1.96*intra*sq))/sq
zeta_beta
intra
sq
1.96*intra*sq
6 - 1.96*intra*sq
29/3
bd <- read.csv("Crossover.csv", header=T, sep=";")
View(bd)
setwd("~/Desktop/Estadística/4. Quart/Primer quatri/ESTADÍSTICA MÈDICA/BLOC 2. Dissenys especials de prova/10-17.10.2018/Estatus metaanalisis")
bd <- read.csv("Metanalisis_ejemplo.csv", header=T, sep=";")
bd <- as.data.frame(bd)
View(bd)
