library(effects)
library(ggplot2)
library(gridExtra)
library(car)
library(AER)
library(MASS)
install.packages("effects")
install.packages("ggplot2")
install.packages("gridExtra")
install.packages("car")
install.packages("AER")
install.packages("pscl")
install.packages("data.table")
library(effects)
library(effects)
library(ggplot2)
library(gridExtra)
library(car)
library(AER)
library(MASS)
library(pscl)
library(data.table)
install.packages("R2admb")
install.packages("glmmADMB",repos=c("http://glmmadmb.r-forge.r-project.org/repos",getOption("repos")),
type="source")
install.packages("glmmADMB",repos=c("http://glmmadmb.r-forge.r-project.org/repos",getOption("repos")),
type="source")
library(glmmADMB)
##-- Load packages
library(effects)
library(ggplot2)
library(gridExtra)
library(car)
library(AER)
library(MASS)
library(pscl)
library(data.table)
install.packages("R2admb")
install.packages("R2admb")
install.packages("glmmADMB",repos=c("http://glmmadmb.r-forge.r-project.org/repos",getOption("repos")),
type="source")
library(glmmADMB)
ufo <- read.csv2("UFOsights.csv")
##-- Covert to factors
ufo$Weekday <- factor(ufo$Weekday)
ufo$Month <- factor(ufo$Month)
ufo$Period <- factor(ufo$Period)
##-- Grouped states by region using States data
# Remove one State (Puerto Rico and change the number of another)
ufo$State <- as.character(ufo$State)
ufo2 <- ufo[ufo$State!='PR',]
ufo2$State[ufo2$State=='CT'] <- 'CN'
##-- Load States data
data(States)
States2 <- data.frame(State=rownames(States),Region=States$region)
##-- Merge and create "Region" variable
ufo3 <- merge(ufo2,States2,by='State')
ufo3 <- as.data.table(ufo3)
ufo4 <- ufo3[,.(Sights=sum(Sights)),by=.(Region,Period,Month,Weekday,Hour)]
##-- Merge and create "Region" variable
ufo3 <- merge(ufo2,States2,by='State')
##-- Load States data
data(States)
library(glmmADMB)
##-- Load States data
data(States)
############################
# Inizialitation
############################
##-- Remove objects in memory
rm(list=ls())
##-- Load packages
library(effects)
library(ggplot2)
library(gridExtra)
library(car)
library(AER)
library(MASS)
library(pscl)
library(data.table)
install.packages("R2admb")
library(glmmADMB)
ufo <- read.csv2("UFOsights.csv")
##-- Covert to factors
ufo$Weekday <- factor(ufo$Weekday)
ufo$Month <- factor(ufo$Month)
ufo$Period <- factor(ufo$Period)
##-- Grouped states by region using States data
# Remove one State (Puerto Rico and change the number of another)
ufo$State <- as.character(ufo$State)
ufo2 <- ufo[ufo$State!='PR',]
ufo2$State[ufo2$State=='CT'] <- 'CN'
##-- Load States data
data(States)
States2 <- data.frame(State=rownames(States),Region=States$region)
##-- Merge and create "Region" variable
ufo3 <- merge(ufo2,States2,by='State')
ufo3 <- as.data.table(ufo3)
ufo4 <- ufo3[,.(Sights=sum(Sights)),by=.(Region,Period,Month,Weekday,Hour)]
##-- Add zeros to the hours without sights
df <- expand.grid(unique(ufo4$Region),unique(ufo4$Period),unique(ufo4$Month),unique(ufo4$Weekday),unique(ufo4$Hour))
##-- Add zeros to the hours without sights
df <- expand.grid(unique(ufo4$Region),unique(ufo4$Period),unique(ufo4$Month),unique(ufo4$Weekday),unique(ufo4$Hour))
names(df) <- names(ufo4)[1:5]
ufo5 <- merge(ufo4,df,by=names(ufo4)[1:5],all.y=TRUE)
ufo5$Sights[is.na(ufo5$Sights)] <- 0
##-- Renamed data
ufo <- ufo5
View(ufo)
View(ufo5)
View(ufo)
View(ufo2)
9*3*2*7*4
9*3*12*7*4
############################
# Descriptiva
############################
##-- Numerical univariant
summary(ufo)
##-- Graphical univariant
par(mfrow=c(2,2),las=1)
barplot(table(ufo$Period),main='Period')
barplot(table(ufo$Month),main='Month')
barplot(table(ufo$Weekday),main='Weekday')
barplot(table(ufo$Hour),main='Hour')
##-- Graphical by sights
# Boxplots
par(mfrow=c(2,2),las=1)
boxplot(I(Sights+0.1)~Period,ufo,log='y')
boxplot(I(Sights+0.1)~Month,ufo,log='y')
boxplot(I(Sights+0.1)~Weekday,ufo,log='y')
boxplot(I(Sights+0.1)~Hour,ufo,log='y')
# Barplots
gg1 <- ggplot(ufo, aes(x=Period,y=Sights)) + geom_col()
gg2 <- ggplot(ufo, aes(x=Month,y=Sights)) + geom_col()
gg3 <- ggplot(ufo, aes(x=Weekday,y=Sights)) + geom_col()
gg4 <- ggplot(ufo, aes(x=Hour,y=Sights)) + geom_col()
grid.arrange(gg1,gg2,gg3,gg4,ncol=2)
ggplot(ufo, aes(x=Region,y=Sights)) + geom_col()
############################
# Poisson model
############################
##-- Initial model with all first order interactions except for Region
m1 <- glm(Sights ~ Region + (Period+Weekday+Month+Hour)^2,ufo,family=poisson)
summary(m1)
anova(m1)
